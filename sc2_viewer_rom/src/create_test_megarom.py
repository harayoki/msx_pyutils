import sys

if len(sys.argv) < 2:
    print("set out.rom"); sys.exit(1)

out = sys.argv[1]
rom = bytearray(0x10000)

boot = [
    0x41,0x42,0x10,0x40,0,0,0,0,0,0,0,0,0,0,0,0,
    0xF3,0x31,0x80,0xF3,

    0x3E,0,0xCD,0x5F,0x00,  # SCREEN0

    0x3E,1,
    0x32,0,0x70,

    0xCD,0x38,0x01,  # RSLREG
    0x0F,0x0F,0x0F,0x0F,  # RRCA
    0xE6,0x03,  # AND 3
    0x21,0x00,0xC0,  # HL=0C000h
    0xCD,0x24,0x00,  # ENASLT

    0x3A,0,0x80,  # A=(8000h)
    0xFE,1,  # CP 1
    0x20,4,  # NZ jump
    0x3E, ord('1'),
    0x18,2,  # JR
    0x3E, ord('0'),
    0xCD,0xA2,0x00,  # CHPUT

    0xc9
]

rom[0x4000:0x4000+len(boot)] = boot
rom[0x8000] = 1

with open(out,"wb") as f:
    f.write(rom)
    # ASCII16SRAM2
print(out)
