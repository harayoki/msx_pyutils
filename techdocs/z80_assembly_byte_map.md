# Z80アセンブリとバイト列の対応表

Z80命令が機械語バイト列としてどのように配置されるかをまとめた早見表です。`nn`はリトルエンディアンの16ビット値、`n`は8ビット即値、`e`は相対オフセット（符号付き8ビット）を表します。

## 単バイト命令

| アセンブリ | バイト列 (16進) | 補足 |
| --- | --- | --- |
| `NOP` | `00` | 無操作 |
| `HALT` | `76` | クロックが停止し割り込み待ち |
| `RLCA` | `07` | Aレジスタの左ローテート（キャリーフラグへ） |
| `RRCA` | `0F` | Aレジスタの右ローテート（キャリーフラグへ） |
| `RLA` | `17` | Aレジスタの左ローテート（キャリーフラグ経由） |
| `RRA` | `1F` | Aレジスタの右ローテート（キャリーフラグ経由） |
| `DAA` | `27` | 2進化10進補正 |
| `CPL` | `2F` | Aレジスタをビット反転 |
| `SCF` | `37` | キャリーフラグセット |
| `CCF` | `3F` | キャリーフラグ反転 |
| `EX DE,HL` | `EB` | DEとHLを交換 |
| `DI` | `F3` | 割り込み禁止 |
| `EI` | `FB` | 割り込み許可 |

## 8ビットロード命令

| アセンブリ | バイト列 (16進) | 補足 |
| --- | --- | --- |
| `LD A,n` | `3E nn` | 即値をAへ |
| `LD B,n` | `06 nn` | 即値をBへ |
| `LD C,n` | `0E nn` | 即値をCへ |
| `LD D,n` | `16 nn` | 即値をDへ |
| `LD E,n` | `1E nn` | 即値をEへ |
| `LD H,n` | `26 nn` | 即値をHへ |
| `LD L,n` | `2E nn` | 即値をLへ |
| `LD (HL),n` | `36 nn` | HLが指すメモリへ即値格納 |
| `LD A,(HL)` | `7E` | HLが指すメモリをAへ |
| `LD (HL),A` | `77` | AをHLが指すメモリへ |
| `LD A,(BC)` | `0A` | BCが指すメモリをAへ |
| `LD A,(DE)` | `1A` | DEが指すメモリをAへ |
| `LD (BC),A` | `02` | AをBCが指すメモリへ |
| `LD (DE),A` | `12` | AをDEが指すメモリへ |

## 16ビットロード命令

| アセンブリ | バイト列 (16進) | 補足 |
| --- | --- | --- |
| `LD BC,nn` | `01 nn nn` | リトルエンディアン16ビット値をBCへ |
| `LD DE,nn` | `11 nn nn` | 〃 |
| `LD HL,nn` | `21 nn nn` | 〃 |
| `LD SP,nn` | `31 nn nn` | 〃 |
| `LD HL,(nn)` | `2A nn nn` | メモリからHLへロード |
| `LD (nn),HL` | `22 nn nn` | HLの内容をメモリへ書き込み |
| `LD SP,HL` | `F9` | HLをスタックポインタへコピー |
| `LD HL,SP+e` | `F8` | SPに符号付きオフセットを加算 |
| `PUSH BC` | `C5` | スタックへプッシュ |
| `PUSH DE` | `D5` | 〃 |
| `PUSH HL` | `E5` | 〃 |
| `PUSH AF` | `F5` | 〃 |
| `POP BC` | `C1` | スタックからポップ |
| `POP DE` | `D1` | 〃 |
| `POP HL` | `E1` | 〃 |
| `POP AF` | `F1` | 〃 |

## 算術・論理命令（即値版）

| アセンブリ | バイト列 (16進) | 補足 |
| --- | --- | --- |
| `ADD A,n` | `C6 nn` | Aに8ビット即値を加算 |
| `ADC A,n` | `CE nn` | キャリー込み加算 |
| `SUB n` | `D6 nn` | 即値を減算 |
| `SBC A,n` | `DE nn` | キャリー込み減算 |
| `AND n` | `E6 nn` | 論理AND |
| `XOR n` | `EE nn` | 排他的OR |
| `OR n` | `F6 nn` | 論理OR |
| `CP n` | `FE nn` | 即値と比較 |

## 16ビット演算

| アセンブリ | バイト列 (16進) | 補足 |
| --- | --- | --- |
| `ADD HL,BC` | `09` | HLにBCを加算 |
| `ADD HL,DE` | `19` | 〃 |
| `ADD HL,HL` | `29` | 〃 |
| `ADD HL,SP` | `39` | 〃 |
| `INC BC` | `03` | 16ビットインクリメント |
| `DEC BC` | `0B` | 16ビットデクリメント |
| `INC DE` | `13` | 〃 |
| `DEC DE` | `1B` | 〃 |
| `INC HL` | `23` | 〃 |
| `DEC HL` | `2B` | 〃 |
| `INC SP` | `33` | 〃 |
| `DEC SP` | `3B` | 〃 |

## 分岐命令

| アセンブリ | バイト列 (16進) | 補足 |
| --- | --- | --- |
| `DJNZ e` | `10 ee` | Bをデクリメントし非ゼロなら相対ジャンプ |
| `JR e` | `18 ee` | 無条件相対ジャンプ |
| `JR NZ,e` | `20 ee` | Z=0のとき相対ジャンプ |
| `JR Z,e` | `28 ee` | Z=1のとき相対ジャンプ |
| `JR NC,e` | `30 ee` | C=0のとき相対ジャンプ |
| `JR C,e` | `38 ee` | C=1のとき相対ジャンプ |
| `JP nn` | `C3 nn nn` | 無条件ジャンプ |
| `JP NZ,nn` | `C2 nn nn` | Z=0のときジャンプ |
| `JP Z,nn` | `CA nn nn` | Z=1のときジャンプ |
| `JP NC,nn` | `D2 nn nn` | C=0のときジャンプ |
| `JP C,nn` | `DA nn nn` | C=1のときジャンプ |
| `JP PO,nn` | `E2 nn nn` | パリティオーバーフロー=0 |
| `JP PE,nn` | `EA nn nn` | パリティオーバーフロー=1 |
| `JP P,nn` | `F2 nn nn` | 符号フラグ=0 |
| `JP M,nn` | `FA nn nn` | 符号フラグ=1 |
| `JP (HL)` | `E9` | HLが指すアドレスへジャンプ |
| `CALL nn` | `CD nn nn` | サブルーチン呼び出し |
| `CALL NZ,nn` | `C4 nn nn` | Z=0のとき呼び出し |
| `CALL Z,nn` | `CC nn nn` | Z=1のとき呼び出し |
| `CALL NC,nn` | `D4 nn nn` | C=0のとき呼び出し |
| `CALL C,nn` | `DC nn nn` | C=1のとき呼び出し |
| `CALL PO,nn` | `E4 nn nn` | パリティオーバーフロー=0 |
| `CALL PE,nn` | `EC nn nn` | パリティオーバーフロー=1 |
| `CALL P,nn` | `F4 nn nn` | 符号フラグ=0 |
| `CALL M,nn` | `FC nn nn` | 符号フラグ=1 |
| `RET` | `C9` | サブルーチン復帰 |
| `RET NZ` | `C0` | Z=0のとき復帰 |
| `RET Z` | `C8` | Z=1のとき復帰 |
| `RET NC` | `D0` | C=0のとき復帰 |
| `RET C` | `D8` | C=1のとき復帰 |
| `RET PO` | `E0` | パリティオーバーフロー=0 |
| `RET PE` | `E8` | パリティオーバーフロー=1 |
| `RET P` | `F0` | 符号フラグ=0 |
| `RET M` | `F8` | 符号フラグ=1 |
| `RST 00H` | `C7` | リスタートベクタ 0x00 |
| `RST 08H` | `CF` | 0x08 |
| `RST 10H` | `D7` | 0x10 |
| `RST 18H` | `DF` | 0x18 |
| `RST 20H` | `E7` | 0x20 |
| `RST 28H` | `EF` | 0x28 |
| `RST 30H` | `F7` | 0x30 |
| `RST 38H` | `FF` | 0x38 |

## ビット操作・シフト

`CB`プリフィックスを付ける命令は2バイト以上になります。代表的なものを挙げます。

| アセンブリ | バイト列 (16進) | 補足 |
| --- | --- | --- |
| `RL B` | `CB 10` | 左ローテート |
| `RR B` | `CB 18` | 右ローテート |
| `SLA B` | `CB 20` | 左シフト、0埋め |
| `SRA B` | `CB 28` | 右算術シフト |
| `SRL B` | `CB 38` | 右論理シフト |
| `BIT 0,B` | `CB 40` | ビットテスト（ビット0） |
| `BIT 7,A` | `CB 7F` | ビット7テスト |
| `RES 0,(HL)` | `CB 86` | 指定ビットを0へ |
| `SET 7,(HL)` | `CB FE` | 指定ビットを1へ |

## ブロック転送・比較

| アセンブリ | バイト列 (16進) | 補足 |
| --- | --- | --- |
| `LDI` | `ED A0` | (HL)→(DE)、BC--、HL/DE++ |
| `LDD` | `ED A8` | (HL)→(DE)、BC--、HL/DE-- |
| `LDIR` | `ED B0` | BCが0になるまでLDI繰返し |
| `LDDR` | `ED B8` | BCが0になるまでLDD繰返し |
| `CPI` | `ED A1` | (HL)とA比較、BC--、HL++ |
| `CPIR` | `ED B1` | BCが0または一致までCPI繰返し |
| `CPD` | `ED A9` | (HL)とA比較、BC--、HL-- |
| `CPDR` | `ED B9` | BCが0または一致までCPD繰返し |

## 参考

- 16ビット即値やアドレスは常にリトルエンディアン（下位バイトが先）で並びます。
- 条件付きジャンプ／コール／リターンは指定フラグが成立した場合のみ分岐し、成立しない場合は次の命令へ進みます。
- `ED`や`CB`などのプリフィックスは命令ストリーム内で1バイトとして数え、続くオペコードを修飾します。
